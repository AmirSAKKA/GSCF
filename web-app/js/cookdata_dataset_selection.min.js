function rowClick(b){$("#settingsDivBlurr").hide();$(b).find(".radiobutton").attr("CHECKED","CHECKED");$("#datasettable .rowselected").removeClass("rowselected");$(b).addClass("rowselected");$(".datasetTitleHere").html($(b).find(".datasetname").val());$("#calculatorInput").val($(b).find(".equation").val());$("#calculatorRadios input[value="+$(b).find(".aggregation").val()+"]").attr("CHECKED","CHECKED");$("#validationEqImg").remove();var a=$(b).find(".groupAselection").val();if(a.length>0){a=a+"."}var a=a+$(b).find(".groupBselection").val();var c=a.split(".");$("#sampleTable input[type=checkbox]").attr("CHECKED",false);$.each(c,function(){$("#sampleTable input[name="+this+"]").attr("CHECKED",true)});updateFlowItems()}function addRow(){var a=$("<tr>").click(function(){rowClick(this)}).addClass("rowselected").append('<td>                                             <input type="radio"  class="radiobutton"     name="radiobutton"  CHECKED/></td>').append('<td>                                             <input type="text"   class="datasetname"     name="dataset_name" onkeyup="changeDatasetName(this);" style="width:90%" value="Dataset '+datasetCounter+'"/></td>').append('<td><span class="samplesgroupA">0</span> samples <input type="hidden" class="groupAselection" name="dataset_grpA" value="" /></td>').append('<td><span class="samplesgroupB">0</span> samples <input type="hidden" class="groupBselection" name="dataset_grpB" value="" /></td>').append('<td><span class="equationshow"></span>           <input type="hidden" class="equation"        name="dataset_equa" value="" /></td>').append('<td><span class="aggregationshow">average</span> <input type="hidden" class="aggregation"     name="dataset_aggr" value="average" /></td>');$("#addnewdatasetrow").before(a);a.click();datasetCounter=datasetCounter+1}function deleteRow(){var a=$("#datasettable input.radiobutton:checked");if(a.size()>0){a.parent().parent().remove();$("#settingsDivBlurr").show()}$(".datasetTitleHere").html("...");$("#sampleTable input[type=checkbox]").attr("CHECKED",false);$("#calculatorInput").val("")}function duplicateRow(){var b=$("#datasettable input.radiobutton:checked");if(b.size()>0){var a=b.parent().parent().clone(true);$("#datasettable .rowselected").removeClass("rowselected");$("#addnewdatasetrow").before(a);$("#settingsDivBlurr").hide();updateFlowItems()}}function changeDatasetName(a){$(".datasetTitleHere").html($(a).val());updateFlowItems()}function checkSampleGroup(){var d=0;var c=0;var b="";var a="";$("#sampleTable tbody tr").each(function(){var e=parseInt($(this).find("td.numSamples").html());var f=$(this).find("input[type=checkbox]").get(0);if($(f).attr("CHECKED")=="checked"){d=d+e;if(b.length>0){b=b+"."}b=b+$(f).attr("name")}f=$(this).find("input[type=checkbox]").get(1);if($(f).attr("CHECKED")=="checked"){c=c+e;if(a.length>0){a=a+"."}a=a+$(f).attr("name")}});$("#datasettable .rowselected .samplesgroupA").html(d);$("#datasettable .rowselected .groupAselection").val(b);$("#datasettable .rowselected .samplesgroupB").html(c);$("#datasettable .rowselected .groupBselection").val(a);updateFlowItems()}function addSymbol(a){$("#calculatorInput").val($("#calculatorInput").val()+a);$("#datasettable .rowselected .equation").val($("#calculatorInput").val());$("#datasettable .rowselected .equationshow").html($("#calculatorInput").val());updateFlowItems()}function validateEquation(){$.ajax({url:"testEquation",data:{equation:$("#calculatorInput").val()},dataType:"JSON",async:false,success:function(a){$("#validationEqImg").remove();if(!a.status){$("#calculatorInput").before('<img id="validationEqImg" src="${fam.icon( name: \'exclamation\' )}" style="vertical-align: text-bottom; display: inline-block;"/>')}else{$("#calculatorInput").before('<img id="validationEqImg" src="${fam.icon( name: \'accept\' )}" style="vertical-align: text-bottom; display: inline-block;"/>')}}})}function changeAggr(a){$("#datasettable .rowselected .aggregation").val($(a).val());$("#datasettable .rowselected .aggregationshow").html($(a).val());updateFlowItems()}function updateFlowItems(){$("#datasetTableHtmlDiv").html('<input id="datasetTableHtml" name="datasetTableHtml" value="'+htmlEscape($("#datasettable tbody").html())+'" type="text"><input id="datasetCounter" name="datasetCounter" value="'+datasetCounter+'" type="text">')}function htmlEscape(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};