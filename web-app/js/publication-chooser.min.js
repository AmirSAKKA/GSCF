function PublicationChooser(){}PublicationChooser.init=function(a){$("input[rel*='publication']").each(function(){new PublicationChooser().initAutocomplete(this,a)})};PublicationChooser.prototype={minLength:3,cache:[],maxResults:8,database:"",availableDBs:{},events:{},initAutocomplete:function(c,f){var d=this;var j=$(c);var b=false;if(!e){var e=".."}var g=document.createElement("img");g.setAttribute("id",j.attr("id")+"_spinner");g.setAttribute("src",e+"/images/spinner.gif");g.setAttribute("style","margin-left: 5px;");j.after(g);$(g).hide();var k=document.createElement("span");k.setAttribute("id",j.attr("id")+"_notfound");var a=document.createElement("img");a.setAttribute("id",j.attr("id")+"_delete");a.setAttribute("src",e+"/plugins/famfamfam-1.0.1/images/icons/delete.png");a.setAttribute("style","margin-left: 5px; margin-right: 5px; ");k.appendChild(a);k.appendChild(document.createTextNode("No publications found."));$(g).after(k);$(k).hide();var h=j.attr("rel").split("-");if(h.length>1){if(this.availableDBs[h[1]]){this.database=h[1];this.events=this.availableDBs[this.database]}else{this.database=h[1]+" (custom)";this.events={}}}else{this.database="(custom)";this.events={}}if(f){$.each(f,function(m,l){d.events[m]=l})}if(!this.events.source){alert("Database "+this.database+" not supported. Using none.")}this.cache[this.database]=[];j.autocomplete({minLength:d.minLength,delay:300,source:function(n,m){var l=function(p){if(p==null){p=new Array()}if(p.length==0){$("#"+j.attr("id")+"_spinner").hide();$("#"+j.attr("id")+"_notfound").show()}m(p)};var o=$.trim(n.term);if(d.cache[d.database][o]){l(d.cache[d.database][o])}else{if(d.database!=""&&d.events.source){d.events.source(d,o,l)}}},search:function(l,m){d.selected=false;$("#"+j.attr("id")+"_spinner").show();$("#"+j.attr("id")+"_notfound").hide()},open:function(l,m){$("#"+j.attr("id")+"_spinner").hide();$("#"+j.attr("id")+"_notfound").hide()},select:function(l,m){d.selected=true;if(d.database!=""&&d.events.select){d.events.select(d,j,l,m)}},close:function(l,m){if(!d.selected){if(d.database!=""&&d.events.close){d.events.close(d,j,l,m)}if(j.closePublication){j.closePublication(d,l,m)}}}});var i;if(this.database!=""&&this.availableDBs[d.database]&&this.availableDBs[d.database]["render"]){i=this.availableDBs[d.database]["render"]}else{i=this.renderPublication}j.data("autocomplete")._renderItem=function(l,m){return d.renderAutoCompleteText(l,m,i(m))}},renderAutoCompleteText:function(a,b,c){return $("<li></li>").data("item.autocomplete",b).append("<a>"+c+"</a>").appendTo(a)},renderPublication:function(a){return a.title+"<br><span style='font-size: 7pt;' class='authors'>"+a.authors.join(", ")+"</span>"},setInputValue:function(e,c,d){var a=e.attr("name")+"-"+c;var b=e.parent().find("input[name='"+a+"']");if(b.size()>0){$(b[0]).val(d)}else{e.after('<input type="hidden" name="'+a+'" value="'+d+'"/>')}}};